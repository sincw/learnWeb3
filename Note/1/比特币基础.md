# 比特币原理

比特币是区块链的起源，学习比特币原理有助于我们后来的学习

**计划列表**

| Name                  | 学习内容                                                                                            | 学习时长 | 备注                       |
|:--------------------- | ----------------------------------------------------------------------------------------------- | ---- | ------------------------ |
| 1.比特币白皮书              | https://bitcoin.org/files/bitcoin-paper/bitcoin_zh_cn.pdf                                       | 2h   | 容易读懂，但是对于一些概念还是比较模糊      |
| 2.登链社区                | https://learnblockchain.cn/                                                                     |      | 国内web3学习交流网站             |
| 3.bitcoin core钱包安装/使用 | https://bitcoin.org/zh_CN/download </br> https://blog.csdn.net/lisemi/article/details/102858186 | 4h   | 搭建regtest网络，熟悉各种转账，挖矿等操作 |
| 4.比特币源码阅读             | https://github.com/bitcoin/bitcoin                                                              | 1h   | 并没有读懂，没有深入了解逻辑，主要了解代码结构。 |
| 5.使用擅长的语言实现比特币        | https://gitee.com/sincw/web3/tree/master/code/bitcoin                                           | 30h  | 使用javaweb实现常用命令，网络部分未实现  |

---

## 一、概述

##### 什么是比特币

比特币想通过一种没有任何权威中心所左右的方式来发行货币，让货币只包含经济价值。

比特币(BTC)是基于<mark>密码学</mark>、依托于区块链技术的一种<mark>去中心化</mark>传输模式的加密<mark>货币</mark>。比特币具有匿名、不可更改、不能伪造的特点。

##### 如何获得比特币

生产/交易，这里主要考虑生产的情况，生产通过计算机解决比特币要求的数据难题，就能获得一定的比特币，简称挖矿。

[比特币是什么 - 通俗易懂篇 | 登链社区 | 区块链技术社区](https://learnblockchain.cn/2017/10/23/whatisbitcoin/)

##### 比特币账本结构

比特币的账本(`ledger`)是以区块链(`block chain`)的形式组织起来的，其结构如下图所示。每个区块里包含了一个字段`previousblockhash`，记录着上一个区块的哈希值。每个区块可以分成两个部分，区块头和交易列表。

![](D:\Learn\web3\note\一\image\5b7c4de446654fb5ad41278c111336dc.png)

 比特币区块各字段如下表所示

| 字段                | 说明                                      |
| ----------------- | --------------------------------------- |
| hash              | 当前区块Hash                                |
| confirmations     | 区块链网络确认数                                |
| size              | 区块大小                                    |
| height            | 区块高度                                    |
| version           | 区块版本                                    |
| versionHex        | 区块版本的16进制表示                             |
| merkleroot        | 区块中所有交易的merkle根Hash                     |
| tx                | 交易列表                                    |
| time              | 区块的时间戳                                  |
| mediantime        | 过去11个区块的中值时间                            |
| nonce             | 32位的任意随机数，挖矿时用于工作量证明算法的一个扰动输入参数         |
| bits              | 区块的难度目标                                 |
| chainwork         | 区块链上的总计工作量，它是一个32位的整数，代表了区块链上所有区块的计算工作量 |
| previousblockhash | 前一个区块的Hash值                             |
| nextblockhash     | 下一个区块的Hash值                             |

##### 比特币记账

任何需要保存的信息，都可以写入区块链，也可以从里面读取，所以它也可以看成一个去中心化数据库或账本。其次，任何人都可以架设服务器，加入区块链网络，成为一个节点。区块链的世界里面，没有中心节点，每个节点都是平等的，都保存着整个数据库。你可以向任何一个节点，写入/读取数据，因为所有节点最后都会同步，保证区块链一致。

##### 挖矿

比特币网络中的节点竞争记账权，获得记账权的节点就会获得一定数量的比特币。

##### 查看区块数据

https://www.blockchain.com/explorer

### 二、基础

##### Merkle tree

![](image\a302fdde7af341279de4fb696c31c9b4.png)

##### UTXO 模型

UTXO 模型中，交易只是代表了 UTXO 集合的变更，由输入和输出组成。而账户和余额的概念是在 UTXO 集合上更高的抽象，账号和余额的概念只存在于钱包中。没有传统的帐户表，而是存储在链上。想要获取某个账户的余额，只能遍历整个账本（钱包的工作），找到属于自己的未花费的UTXO。

![](image\521303788.jpeg)

##### 

##### coinbase交易

每个区块的第一条交易是`coinbase交易`。`coinbase交易`会生成新的比特币，要生成新的比特币，只能通过`coinbase交易`。coinbase交易跟普通交易的区别在于其没有输入，只有输出。

##### 比特币钱包地址如何生成

一个比特币钱包包含一系列的密钥对，每个密钥对包括一个私钥和一个公钥。私钥（k）是一个数字，通常是**随机**产生。有了私钥，我们就可以使用椭圆曲线算法**单向**加密产生一个公钥（K）。有了公钥（K），我们就可以使用一个单向加密哈希函数生成公钥哈希，也就是比特币收款地址（A）。

![](image\v2-4d07dacd322d3148fab0b839c91e4e43_720w.webp)

##### 锁定脚本

交易1：B收到来自A的转账 1BTC

交易2：B 又转给C  1BTC    

交易2中的   输出包含锁定脚本，  锁定脚本主要包含C的   公钥hash （可以认为公钥hash就代表钱包地址）

##### 解锁脚本

交易1：B收到来自A的转账 1BTC

交易2：B 又转给C 1BTC

B想要用A转给他的钱，他就要证明钱是他的。B对交易1的输出添加签名和公钥后变成交易2的输入（交易的hash值 + B的私钥 进行签名，得到签名A）

矿工收到这笔交易后对其进行验证，遍历账本得到交易，算出交易的hash值，使用公钥解密得到签名B，矿工对比A=B?。如果相等就说明钱是B的，那就可以写入账本，等待打包。

##### 非对称加密

[比特币所有权及隐私问题-非对称加密应用 | 登链社区 | 区块链技术社区](https://learnblockchain.cn/2017/11/02/bitcoin-own/#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF)

##### 共识-工作量证明

比特币通过修改nonce值来计算区块的hash,使其满足难度值。将计算结果广播，获得其他节点认可后将数据写入区块。

[比特币如何挖矿（挖矿原理）-工作量证明 | 登链社区 | 区块链技术社区](https://learnblockchain.cn/2017/11/04/bitcoin-pow/)

##### 最长链选择

比特币没有中心机构，几乎所有的完整节点都有一份公共总帐本，那么大家如何达成共识：确认哪一份才是公认权威的总账本呢？

[比特币如何达成共识 - 最长链的选择 | 登链社区 | 区块链技术社区](https://learnblockchain.cn/2017/12/07/bitcoin-sonsensus/)

## 三、比特币网络

[分析比特币网络：一种去中心化、点对点的网络架构 | 登链社区 | 区块链技术社区](https://learnblockchain.cn/2017/11/07/bitcoin-p2p/)
